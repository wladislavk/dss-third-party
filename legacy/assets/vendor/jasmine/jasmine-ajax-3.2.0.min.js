getJasmineRequireObj().ajax=function(b){var a={};a.RequestStub=b.AjaxRequestStub();a.RequestTracker=b.AjaxRequestTracker();a.StubTracker=b.AjaxStubTracker();a.ParamParser=b.AjaxParamParser();a.event=b.AjaxEvent();a.eventBus=b.AjaxEventBus(a.event);a.fakeRequest=b.AjaxFakeRequest(a.eventBus);a.MockAjax=b.MockAjax(a);return a.MockAjax};getJasmineRequireObj().AjaxEvent=function(){function c(){return new Date().getTime()}function d(){}function b(f,e){this.type=e;this.bubbles=false;this.cancelable=false;this.timeStamp=c();this.isTrusted=false;this.defaultPrevented=false;this.eventPhase=2;this.target=f;this.currentTarget=f}b.prototype.preventDefault=d;b.prototype.stopPropagation=d;b.prototype.stopImmediatePropagation=d;function a(){b.apply(this,arguments);this.lengthComputable=false;this.loaded=0;this.total=0}a.prototype=b.prototype;return{event:function(f,e){return new b(f,e)},progressEvent:function(f,e){return new a(f,e)}}};getJasmineRequireObj().AjaxEventBus=function(c){function b(e){this.eventList={};this.source=e}function a(f,e){f[e]=f[e]||[];return f[e]}function d(g,e){if(g.indexOf){return g.indexOf(e)}for(var f=0;f<g.length;f++){if(e===g[f]){return f}}return -1}b.prototype.addEventListener=function(e,f){a(this.eventList,e).push(f)};b.prototype.removeEventListener=function(f,g){var e=d(this.eventList[f],g);if(e>=0){this.eventList[f].splice(e,1)}};b.prototype.trigger=function(g){var e;if(g==="readystatechange"){e=c.event(this.source,g)}else{e=c.progressEvent(this.source,g)}var h=this.eventList[g];if(h){for(var f=0;f<h.length;f++){h[f].call(this.source,e)}}};return function(e){return new b(e)}};getJasmineRequireObj().AjaxFakeRequest=function(e){function g(h,k,i){i=i||[];for(var j in k){if(!f(i,j)){h[j]=k[j]}}return h}function f(h,k){for(var j=0;j<h.length;j++){if(h[j]===k){return true}}return false}function a(i,h){return function(){if(i[h]){i[h].apply(i,arguments)}}}function d(h){h.eventBus.addEventListener("readystatechange",a(h,"onreadystatechange"));h.eventBus.addEventListener("loadstart",a(h,"onloadstart"));h.eventBus.addEventListener("load",a(h,"onload"));h.eventBus.addEventListener("loadend",a(h,"onloadend"));h.eventBus.addEventListener("progress",a(h,"onprogress"));h.eventBus.addEventListener("error",a(h,"onerror"));h.eventBus.addEventListener("abort",a(h,"onabort"));h.eventBus.addEventListener("timeout",a(h,"ontimeout"))}function c(h){var i=["Can't build XHR.response for XHR.responseType of '",h,"'.","XHR.response must be explicitly stubbed"];return i.join(" ")}function b(i,k,h,q){function l(){k.track(this);this.eventBus=e(this);d(this);this.requestHeaders={};this.overriddenMimeType=null}function m(s,t){s=s.toLowerCase();for(var u in t){if(u.toLowerCase()===s){return t[u]}}}function r(v,u){var s=[];if(v){if(v instanceof Array){s=v}else{for(var t in v){if(v.hasOwnProperty(t)){s.push({name:t,value:v[t]})}}}}else{s.push({name:"Content-Type",value:u||"application/json"})}return s}function o(t,u){if(i.DOMParser){return(new i.DOMParser()).parseFromString(t,"text/xml")}else{var s=new i.ActiveXObject("Microsoft.XMLDOM");s.async="false";s.loadXML(t);return s}}var p=["text/xml","application/xml"];function n(s,t){if(f(p,t.toLowerCase())){return o(s,t)}else{if(t.match(/\+xml$/)){return o(s,"text/xml")}}return null}var j=["responseBody","responseText","responseXML","status","statusText","responseTimeout"];g(l.prototype,new i.XMLHttpRequest(),j);g(l.prototype,{open:function(){this.method=arguments[0];this.url=arguments[1];this.username=arguments[3];this.password=arguments[4];this.readyState=1;this.eventBus.trigger("readystatechange")},setRequestHeader:function(t,s){if(this.requestHeaders.hasOwnProperty(t)){this.requestHeaders[t]=[this.requestHeaders[t],s].join(", ")}else{this.requestHeaders[t]=s}},overrideMimeType:function(s){this.overriddenMimeType=s},abort:function(){this.readyState=0;this.status=0;this.statusText="abort";this.eventBus.trigger("readystatechange");this.eventBus.trigger("progress");this.eventBus.trigger("abort");this.eventBus.trigger("loadend")},readyState:0,onloadstart:null,onprogress:null,onabort:null,onerror:null,onload:null,ontimeout:null,onloadend:null,onreadystatechange:null,addEventListener:function(){this.eventBus.addEventListener.apply(this.eventBus,arguments)},removeEventListener:function(s,t){this.eventBus.removeEventListener.apply(this.eventBus,arguments)},status:null,send:function(s){this.params=s;this.eventBus.trigger("loadstart");var t=h.findStub(this.url,s,this.method);if(t){if(t.isReturn()){this.respondWith(t)}else{if(t.isError()){this.responseError()}else{if(t.isTimeout()){this.responseTimeout()}}}}},contentType:function(){return m("content-type",this.requestHeaders)},data:function(){if(!this.params){return{}}return q.findParser(this).parse(this.params)},getResponseHeader:function(t){t=t.toLowerCase();var s;for(var u=0;u<this.responseHeaders.length;u++){var v=this.responseHeaders[u];if(t===v.name.toLowerCase()){if(s){s=[s,v.value].join(", ")}else{s=v.value}}}return s},getAllResponseHeaders:function(){var t=[];for(var s=0;s<this.responseHeaders.length;s++){t.push(this.responseHeaders[s].name+": "+this.responseHeaders[s].value)}return t.join("\r\n")+"\r\n"},responseText:null,response:null,responseType:null,responseValue:function(){switch(this.responseType){case null:case"":case"text":return this.readyState>=3?this.responseText:"";case"json":return JSON.parse(this.responseText);case"arraybuffer":throw c("arraybuffer");case"blob":throw c("blob");case"document":return this.responseXML}},respondWith:function(s){if(this.readyState===4){throw new Error("FakeXMLHttpRequest already completed")}this.status=s.status;this.statusText=s.statusText||"";this.responseHeaders=r(s.responseHeaders,s.contentType);this.readyState=2;this.eventBus.trigger("readystatechange");this.responseText=s.responseText||"";this.responseType=s.responseType||"";this.readyState=4;this.responseXML=n(s.responseText,this.getResponseHeader("content-type")||"");if(this.responseXML){this.responseType="document"}if("response" in s){this.response=s.response}else{this.response=this.responseValue()}this.eventBus.trigger("readystatechange");this.eventBus.trigger("progress");this.eventBus.trigger("load");this.eventBus.trigger("loadend")},responseTimeout:function(){if(this.readyState===4){throw new Error("FakeXMLHttpRequest already completed")}this.readyState=4;jasmine.clock().tick(30000);this.eventBus.trigger("readystatechange");this.eventBus.trigger("progress");this.eventBus.trigger("timeout");this.eventBus.trigger("loadend")},responseError:function(){if(this.readyState===4){throw new Error("FakeXMLHttpRequest already completed")}this.readyState=4;this.eventBus.trigger("readystatechange");this.eventBus.trigger("progress");this.eventBus.trigger("error");this.eventBus.trigger("loadend")}});return l}return b};getJasmineRequireObj().MockAjax=function(a){function b(f){var d=new a.RequestTracker(),c=new a.StubTracker(),e=new a.ParamParser(),h=f.XMLHttpRequest,g=a.fakeRequest(f,d,c,e);this.install=function(){if(f.XMLHttpRequest===g){throw"MockAjax is already installed."}f.XMLHttpRequest=g};this.uninstall=function(){f.XMLHttpRequest=h;this.stubs.reset();this.requests.reset();e.reset()};this.stubRequest=function(i,j,l){var k=new a.RequestStub(i,j,l);c.addStub(k);return k};this.withMock=function(i){this.install();try{i()}finally{this.uninstall()}};this.addCustomParamParser=function(i){e.add(i)};this.requests=d;this.stubs=c}return b};getJasmineRequireObj().AjaxParamParser=function(){function a(){var e=[{test:function(f){return(/^application\/json/).test(f.contentType())},parse:function b(f){return JSON.parse(f)}},{test:function(f){return true},parse:function d(l){var j={};var k=l.split("&");for(var g=0;g<k.length;++g){var h=k[g].replace(/\+/g," ").split("=");var f=decodeURIComponent(h[0]);j[f]=j[f]||[];j[f].push(decodeURIComponent(h[1]))}return j}}];var c=[];this.add=function(f){c.unshift(f)};this.findParser=function(g){for(var f in c){var h=c[f];if(h.test(g)){return h}}};this.reset=function(){c=[];for(var f in e){c.push(e[f])}};this.reset()}return a};getJasmineRequireObj().AjaxRequestStub=function(){var c=0,b=1,a=2;function d(g,f,i){var e=function(j){return j?j.split("&").sort().join("&"):undefined};if(g instanceof RegExp){this.url=g;this.query=undefined}else{var h=g.split("?");this.url=h[0];this.query=h.length>1?e(h[1]):undefined}this.data=(f instanceof RegExp)?f:e(f);this.method=i;this.andReturn=function(j){this.action=c;this.status=j.status||200;this.contentType=j.contentType;this.response=j.response;this.responseText=j.responseText;this.responseHeaders=j.responseHeaders};this.isReturn=function(){return this.action===c};this.andError=function(){this.action=b};this.isError=function(){return this.action===b};this.andTimeout=function(){this.action=a};this.isTimeout=function(){return this.action===a};this.matches=function(j,p,q){var m=false;j=j.toString();if(this.url instanceof RegExp){m=this.url.test(j)}else{var n=j.split("?"),l=n[0],o=n[1];m=this.url===l&&this.query===e(o)}var k=false;if(this.data instanceof RegExp){k=this.data.test(p)}else{k=!this.data||this.data===e(p)}return m&&k&&(!this.method||this.method===q)}}return d};getJasmineRequireObj().AjaxRequestTracker=function(){function a(){var b=[];this.track=function(c){b.push(c)};this.first=function(){return b[0]};this.count=function(){return b.length};this.reset=function(){b=[]};this.mostRecent=function(){return b[b.length-1]};this.at=function(c){return b[c]};this.filter=function(e){var d=[];for(var c=0;c<b.length;c++){if(e instanceof RegExp&&e.test(b[c].url)){d.push(b[c])}else{if(e instanceof Function&&e(b[c])){d.push(b[c])}else{if(b[c].url===e){d.push(b[c])}}}}return d}}return a};getJasmineRequireObj().AjaxStubTracker=function(){function a(){var b=[];this.addStub=function(c){b.push(c)};this.reset=function(){b=[]};this.findStub=function(c,e,g){for(var d=b.length-1;d>=0;d--){var f=b[d];if(f.matches(c,e,g)){return f}}}}return a};(function(){var a=getJasmineRequireObj(),b=a.ajax(a);if(typeof window==="undefined"&&typeof exports==="object"){exports.MockAjax=b;jasmine.Ajax=new b(exports)}else{window.MockAjax=b;jasmine.Ajax=new b(window)}}());